---
title: "Homework 2"
author: "Jenn Lewis, Karlena Ochoa, Katie Denning"
date: "2/20/2019"
output: html_document
---

```{r setup}
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE,
                      warning = FALSE)

library(gghighlight)
library(tidyverse)
library(rio)
library(here)
library(ggrepel)


data <- import("https://www.denvergov.org/media/gis/DataCatalog/crime/csv/crime.csv") %>%
  janitor::clean_names()

glimpse(data)

```




```{r Question 1 Replicate Plot}

#Things I Can't Figure out:  I can't figure out how to clean up the names of the offense categories easily.
#Not sure why his graph doesn't have traffic accidents


crime_percent <- data %>%
  count(offense_category_id) %>%
  mutate(Percent = (n/sum(n)),
         prop_se = (sqrt((Percent*(1-Percent)) / n))) 

crime_percent %>%
 ggplot(aes(fct_reorder(offense_category_id, Percent), Percent)) +
  geom_errorbar(aes(ymin = Percent + qnorm(0.025)*prop_se,
                    ymax = Percent + qnorm(0.975)*prop_se)) +
  geom_point(color = "cornflower blue") +
  coord_flip() +
  theme_minimal() +
  scale_y_continuous(labels = scales::percent, limits = c(NA, .3)) +
  labs(x = "",
       title = "Crimes in Denver",
       caption = "Denver Crime Data Distributed via Kaggle
       https://www.kaggle.com/paultimothymooney/denver-crime-data")

```


```{r Question 2 Same Relationship Different Uncertainty Visualization}



```


```{r Question 3 Reproduce plot}

```


```{r Question 4 Dot Plot }

```


```{r Question 5 Reproduce Table }

```

